<odoo>
  <data>
   <record id="imputaciones_view_tree" model="ir.ui.view">
    <field name="name">imputaciones.view.tree</field>
    <field name="model">imputaciones</field>
    <field name="arch" type="xml">
      <tree string="Imputaciones">
        <field name="name" string="Resumen" />
        <field name="ticket" string="Ticket"/>
        <field name="partner_id" string="Partner"/>
        <field name="case_id"/>
        <field name="project_id" />
        <field name="task_id" />
        <field name="fecha_inicio" string ="Fecha Inicio"/>
        <field name="fecha_final" string ="Fecha Fin"/>         
        <field name="state" />
      </tree>
    </field>
   </record>

    <record id="imputaciones_view_form" model="ir.ui.view">
    <field name="name">imputaciones.view.form</field>
    <field name="model">imputaciones</field>
    <field name="arch" type="xml">
    <form string="Imputaciones">
    <header>
        <field name="state" widget="statusbar"/>
        <button name="enprogreso" string="En Progreso" type="object" class="oe_stat_button" invisible="state in ('1','2','3')"/> 
        <button name="finalizar" string="Finalizar" type="object" class="oe_stat_button" invisible="state in ('0','2','3')"/> 
        <button name="imputado" string="Imputado" type="object" class="oe_stat_button" invisible="state in ('0','1','3')"/>            
        <button name="recalcular" string="Recalcular" type="object" class="oe_stat_button" invisible="state in ('0','1','3')"/>
        <button name="imputar" string="Imputar" type="object" class="oe_stat_button" invisible="state in ('0','1','3')"/> 
    </header>
    <sheet>
        <group string="Resumen">
            <group>
                <field name="ticket" string="Ticket"/> 
                <field name="partner_id" string="Partner"/> 
            </group>
            <group>
                <field name="project_id" domain="['|',('partner_id','=',partner_id),('partner_id','=','1567')]" required="True"/>
                <field name="user_id" string="Usuario"/>  
            </group>
            <group string="Detalle">
                <field name="name" required="True" nolabel="1" colspan="2"/>
            </group>
        </group>
        <group string="DescripciÃ³n">
            <field name="descripcion" nolabel="1" colspan="2"/>
        </group>
        <group string="Caso / Proyecto">
            <group>
                <field name="case_id" domain="[('partner_id','=',partner_id)]"/>
            </group>
            <group>
                <field name="task_id" domain="[('project_id','=',project_id)]"/>
            </group>
        </group>
        <group string="Fechas" col="3">
            <group>
                <field name="fecha_inicio" string="Fecha Inicio"/>
            </group>
            <group>
                <field name="fecha_final" string="Fecha Fin"/>
            </group>
            <group>
                <field name="tiempo" string="Tiempo utilizado" readonly="True" widget="timesheet_uom"/>
            </group>
        </group>
        <group string="Tiempos" col="4">
            <group>
                <field name="factor" string="Factor"/>
            </group>
            <group>
                <field name="tiempo_realizado" string="Tiempo Realizado" readonly="True" widget="timesheet_uom"/>
            </group>
            <group>
                <field name="tiempo_manual" string="Tiempo Manual" widget="timesheet_uom"/>
            </group>
            <group>
                <field name="tiempo_facturar" string="Tiempo Facturar" readonly="True" widget="timesheet_uom"/>
            </group>
        </group>
        
    </sheet>
    </form>
    </field>
   </record>

  <record id="imputaciones_view_pivot" model="ir.ui.view">
    <field name="name">imputaciones.view.pivot</field>
    <field name="model">imputaciones</field>
    <field name="arch" type="xml">
      <pivot string="Imputaciones" disable_linking="true">        
        <field name="case_id" type="row"/>
        <field name="fecha_final" interval="day" type="col" />
        <field name="tiempo" type="measure" widget="float_time"/>        
      </pivot>
    </field>
  </record>

   <record id="imputaciones_proyecto_view_pivot" model="ir.ui.view">
    <field name="name">imputaciones.proyecto.view.pivot</field>
    <field name="model">imputaciones</field>
    <field name="arch" type="xml">
      <pivot string="Imputaciones proyectos" disable_linking="true">
        <field name="project_id" type="row"/>
        <field name="task_id" type="row"/>
        <field name="fecha_final" interval="day" type="col" />
        <field name="tiempo" type="measure" widget="float_time"/>        
      </pivot>
    </field>
  </record>
   
<record id="action_imputaciones_imputacion_abierta" model="ir.actions.act_window">
    <field name="name">Imputaciones abiertas</field>
    <field name="res_model">imputaciones</field>    
    <field name="view_mode">tree,form,pivot</field>
    <field name="view_id" ref="imputaciones_view_tree"/>
    <field name="domain">['|',('state','=','0'),('state','=','1')]</field>
</record>

<record id="action_imputaciones_imputacion_cerrada" model="ir.actions.act_window">
    <field name="name">Imputaciones finalizadas</field>
    <field name="res_model">imputaciones</field>    
    <field name="view_mode">tree,form,pivot</field>
    <field name="view_id" ref="imputaciones_view_tree"/>
    <field name="domain">[('state','=','2')]</field>
</record>

<record id="action_imputaciones_imputacion_imputada" model="ir.actions.act_window">
    <field name="name">Imputaciones imputadas</field>
    <field name="res_model">imputaciones</field>    
    <field name="view_mode">tree,form,pivot</field>
    <field name="view_id" ref="imputaciones_view_tree"/>
    <field name="domain">[('state','=','3')]</field>
</record>

<!-- Acciones servidor-->
<record id="imputaciones_unir_action_server" model="ir.actions.server">
    <field name="name">Unir imputaciones</field>
    <field name="type">ir.actions.server</field>
    <field name="model_id" ref="model_imputaciones"/>
    <field name="binding_model_id" ref="model_imputaciones"/>
    <field name="state">code</field>
    <field name="code">unir_imputaciones()</field>
</record>

  </data>
</odoo>